name: Deploy to dev

on: workflow_dispatch

# Google Cloud と OIDC 連携するために id-token: write 権限が必要
permissions:
  contents: read
  id-token: write

jobs:
  deploy:
    needs: build-push
    name: Deploy backend to dev
    uses: ./.github/workflows/deploy-cloud-run.yaml
    with:
      service_name: dev-payment-manager-backend
      yaml_path: ./backend/.infra/grpc-server/dev.yaml
      image_tag: ${{ github.sha }}
      service_account: github-actions@dev-payment-manager.iam.gserviceaccount.com
